<!-- ...existing code... -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Littera</title>
  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="./css/cart.css">
  <link rel="stylesheet" href="./css/checkout-modal.css">
  <link rel="stylesheet" href="./css/busca.css">
  <link rel="stylesheet" href="./css/reservas-modal.css">
    <link rel="icon" type="image/x-icon" href="./img/icones/favicon.ico">

</head>
<body>

  <!-- NAV -->
  <header>
    <div class="top-line"></div>
    <div class="navbar-top">
      <a href="./index.html"><img src="./img/logo2.0.png" alt="Logo" class="logo"></a>

      <!-- Barra de Busca Centralizada -->
      <div class="search-container">
        <div class="search-box" id="searchBox">
          <input type="text" placeholder=" Procure por livros, autores ou categorias..." />
        </div>
      </div>

      <div class="nav-icons">
        <div class="lupa-icon" id="search-toggle">
          <img src="./img/lupa2.0.png" alt="Buscar">
        </div>
        
        <div class="cart-container">
          <img src="./img/carrinho2.0.png" id="carrinho-icon" class="carrinho" onclick="openCart()">
          <span id="cart-count">0</span>
        </div>
        <div class="user-wrapper" onclick="openPopup()">
          <img class="user-icon" src="./img/login2.0.png" id="login-icon" alt="Login">

          <span id="user-name-display"></span>
        </div>
        <div class="menu-icon" id="menu-btn">&#9776;</div>
      </div>
    </div>
  </header>

  <div class="overlay" id="overlay"></div>
  <aside class="sidebar" id="sidebar">
    <a href="#" class="close-btn" id="close-btn">&times;</a>
    <a href="#">Início</a>
    <a href="./sobre.html">Sobre Nós</a>
    <a href="./contato.html">Contato</a>
  </aside>

  <main class="container-busca">
    <!-- Conteúdo (resultados) — agora aparece à esquerda -->
    <section class="conteudo-busca">
      <div class="header-busca">
        <h1>Resultados da busca <span id="busca-query"></span></h1>
        <p id="resultado-count"></p>
      </div>
      <div id="resultados" class="lista-resultados"></div>
    </section>

    <!-- PAINEL DE FILTROS movido para a direita via CSS order -->
    <aside class="sidebar-filtros" id="painelFiltros">
      <div class="filtros-header">
        <h3>Filtros</h3>
        <button class="reset-filtros" id="btnReset">Limpar</button>
      </div>

      <div class="filtro-bloco">
        <h4>Categorias</h4>
        <div class="categorias-chips" id="chipsCategorias">
          <div class="chip" data-cat="Romance">Romance</div>
          <div class="chip" data-cat="Aventura">Aventura</div>
          <div class="chip" data-cat="Ficção">Ficção</div>
          <div class="chip" data-cat="Mistério">Mistério</div>
          <div class="chip" data-cat="Filosofia">Filosofia</div>
          <div class="chip" data-cat="HQs">HQs</div>
          <div class="chip" data-cat="Biografia">Biografia</div>
          <div class="chip" data-cat="Poesia">Poesia</div>
        </div>
      </div>

      <div class="filtro-bloco">
        <h4>Preço máximo</h4>
        <div class="faixa-preco">
          <input type="range" id="rangePreco" min="10" max="300" step="5" value="120">
          <div class="valor" id="valorPreco">R$ 120</div>
        </div>
      </div>

      <div class="filtro-bloco">
        <h4>Ordenar por</h4>
        <select id="ordenarPor" class="select-styled">
          <option value="relevancia">Mais relevantes</option>
          <option value="menor-preco">Menor preço</option>
          <option value="maior-preco">Maior preço</option>
          <option value="lancamento">Lançamentos</option>
        </select>
      </div>

      <div class="filtros-actions">
        <button class="btn-primario" id="btnAplicarFiltros">Aplicar filtros</button>
        <button class="btn-secundario" id="btnVerTudo">Ver tudo</button>
      </div>
    </aside>
  </main>

  <!-- CARRINHO MODAL -->
  <div id="cart-modal" class="cart-modal">
    <div class="cart-modal-overlay">
      <div class="cart-modal-content">
        <div class="cart-modal-header">
          <h2>Carrinho de compras</h2>
          <span class="close-cart" id="close-cart">&times;</span>
        </div>
        <div class="cart-modal-body">
          <div id="cart-items-container"></div>
        </div>
        <div class="cart-modal-footer">
          <div class="cart-footer-left">
            <input type="checkbox" id="cart-select-all">
            <label for="cart-select-all">Selecionar tudo</label>
          </div>
          <div class="cart-footer-middle">
            <span>Subtotal (1 produto): <strong id="cart-total">R$14,99</strong></span>
          </div>
          <button class="btn-checkout">Finalizar Pedido</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Script: preenche search box e mostra query no topo -->
  <script>
    (function() {
      const params = new URLSearchParams(window.location.search);
      const q = params.get('query') || '';
      const sb = document.querySelector('#searchBox input');
      if (sb) sb.value = q;
      const qEl = document.getElementById('busca-query');
      if (qEl && q) qEl.textContent = `"${q}"`;
      if (qEl && !q) qEl.textContent = '';
    })();
  </script>

  <!-- UI filters behaviour (chips, range, aplicar/limpar) -->
  <script>
    // chips
    const chips = document.getElementById('chipsCategorias');
    const selectedCats = new Set();
    chips?.addEventListener('click', (ev) => {
      const chip = ev.target.closest('.chip');
      if (!chip) return;
      const cat = chip.dataset.cat;
      chip.classList.toggle('active');
      if (chip.classList.contains('active')) selectedCats.add(cat);
      else selectedCats.delete(cat);
    });

    // range preco
    const range = document.getElementById('rangePreco');
    const valorPreco = document.getElementById('valorPreco');
    range?.addEventListener('input', () => {
      valorPreco.textContent = 'R$ ' + Number(range.value).toLocaleString('pt-BR');
    });

    // aplicar filtros (adiciona params à URL)
    document.getElementById('btnAplicarFiltros')?.addEventListener('click', () => {
      const params = new URLSearchParams(window.location.search);
      const q = params.get('query') || '';
      if (q) params.set('query', q);
      if (selectedCats.size) params.set('categoria', Array.from(selectedCats).join(','));
      else params.delete('categoria');
      params.set('precoMax', range ? range.value : '');
      params.set('ordenar', document.getElementById('ordenarPor')?.value || 'relevancia');
      window.location.search = params.toString();
    });

    // reset
    document.getElementById('btnReset')?.addEventListener('click', () => {
      document.querySelectorAll('.chip.active').forEach(c => c.classList.remove('active'));
      selectedCats.clear();
      if (range) { range.value = 120; valorPreco.textContent = 'R$ 120'; }
      document.getElementById('ordenarPor').value = 'relevancia';
    });

    // ver tudo
    document.getElementById('btnVerTudo')?.addEventListener('click', () => {
      const params = new URLSearchParams(window.location.search);
      params.delete('categoria'); params.delete('precoMax'); params.delete('ordenar');
      window.location.search = params.toString();
    });
  </script>

  <!-- POPUP LOGIN / CADASTRO -->
  <div id="popupOverlay" class="popup-overlay" style="display: none;">
    <div class="popup-box" role="dialog" aria-modal="true" aria-labelledby="popupTitle">
      <span class="closePopup" id="closePopup">✕</span>

      <!-- LOGIN (padrão) -->
      <div id="login-screen" class="auth-screen">
        <h2 id="popupTitle">Entrar</h2>
        <input type="email" id="login-email" placeholder="Email" required>
        <input type="password" id="login-senha" placeholder="Senha" required>
        <button id="btnLogin" class="btn-submit">Login</button>
        <p class="switch-text">Não possui conta? <a href="#" id="switchToRegister">Cadastre-se</a></p>
      </div>

      <!-- CADASTRO (oculto por padrão) -->
      <div id="cadastro-screen" class="auth-screen hidden">
        <h2>Cadastro</h2>
        <input type="text" id="cad-nome" placeholder="Nome completo" required>
        <input type="email" id="cad-email" placeholder="Email" required>
        <input type="tel" id="cad-telefone" placeholder="Telefone" required>
        <input type="password" id="cad-senha" placeholder="Senha" required>
        <button id="btnCadastrar" class="btn-submit">Cadastrar</button>
        <p class="switch-text">Já possui conta? <a href="#" id="switchToLogin">Faça login</a></p>
      </div>
    </div>
  </div>

  <script src="./js/auth.js"></script>
  <script src="./js/reservas-modal.js"></script>
  <script src="./js/busca.js"></script>
  <script src="./js/script.js"></script>
  <script src="./js/cart-novo.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
  <script src="./js/checkout-modal.js"></script>

  <!-- CHECKOUT MODAL -->
  <div id="checkout-modal" class="checkout-modal">
    <div class="checkout-overlay">
      <div class="checkout-content">
        <button class="checkout-close">×</button>
        <div class="modal-progress">
          <div class="progress-step active" data-step="1"><span class="progress-number">1</span><span class="progress-label">Informações</span></div>
          <div class="progress-line"></div>
          <div class="progress-step" data-step="2"><span class="progress-number">2</span><span class="progress-label">Método</span></div>
          <div class="progress-line"></div>
          <div class="progress-step" data-step="3"><span class="progress-number">3</span><span class="progress-label">Pagamento</span></div>
          <div class="progress-line"></div>
          <div class="progress-step" data-step="4"><span class="progress-number">4</span><span class="progress-label">Confirmação</span></div>
        </div>
        <div class="step-content active" id="step-1">
          <h2>INFORMAÇÕES PESSOAIS</h2>
          <form id="form-informacoes" class="form-step">
            <div class="form-group"><label>Nome Completo</label><input type="text" id="nome-completo" required></div>
            <div class="form-group"><label>CPF</label><input type="text" id="cpf" placeholder="000.000.000-00" required></div>
            <div class="form-group"><label>Data de Nascimento</label><input type="date" id="data-nascimento" required></div>
            <div class="form-group"><label>Rua</label><input type="text" id="rua" required></div>
            <div class="form-group"><label>Bairro</label><input type="text" id="bairro" required></div>
            <div class="form-group"><label>Número</label><input type="number" id="numero" required></div>
            <div class="form-group"><label>CEP</label><input type="text" id="cep" placeholder="00000-000" required></div>
            <div class="form-group"><label>Cidade</label><input type="text" id="cidade" required></div>
            <div class="form-group"><label>Estado</label><select id="estado" required><option value="">Selecione</option><option value="SP">SP</option><option value="RJ">RJ</option><option value="MG">MG</option><option value="BA">BA</option><option value="SC">SC</option><option value="RS">RS</option></select></div>
            <div class="form-actions"><button type="button" class="btn-voltar" onclick="closeCheckoutModal()">← VOLTAR</button><button type="submit" class="btn-proximo">PRÓXIMO →</button></div>
          </form>
        </div>
        <div class="step-content" id="step-2">
          <h2>MÉTODO DE PAGAMENTO</h2>
          <form id="form-metodo" class="form-step">
            <div class="metodos-container">
              <label class="metodo-card active"><input type="radio" name="metodo-pagamento" value="pix" checked><div>PIX</div></label>
              <label class="metodo-card"><input type="radio" name="metodo-pagamento" value="boleto"><div>BOLETO</div></label>
              <label class="metodo-card"><input type="radio" name="metodo-pagamento" value="credito"><div>CARTÃO CRÉDITO</div></label>
              <label class="metodo-card"><input type="radio" name="metodo-pagamento" value="debito"><div>CARTÃO DÉBITO</div></label>
            </div>
            <div class="endereco-entrega"><strong>Entrega para <span id="nome-entrega">Seu Nome</span></strong><p id="endereco-entrega-texto">Endereço será carregado</p></div>
            <div class="form-actions"><button type="button" class="btn-voltar" onclick="prevStep(2)">← VOLTAR</button><button type="submit" class="btn-proximo">PRÓXIMO →</button></div>
          </form>
        </div>
        <div class="step-content" id="step-3">
          <h2>CARTÃO DE CRÉDITO</h2>
          <form id="form-cartao" class="form-step">
            <div class="card-preview"><div id="card-preview-number">**** **** **** ****</div><div id="card-preview-holder">NOME DO TITULAR</div><div id="card-preview-expiry">MM/AA</div></div>
            <div class="form-group"><label>Nome do Titular</label><input type="text" id="nome-titular" required></div>
            <div class="form-group"><label>CPF</label><input type="text" id="cpf-cartao" required></div>
            <div class="form-group"><label>Número do Cartão</label><input type="text" id="numero-cartao" placeholder="0000 0000 0000 0000" maxlength="19" required></div>
            <div class="form-group"><label>Vencimento</label><input type="text" id="vencimento" placeholder="MM/AA" maxlength="5" required></div>
            <div class="form-group"><label>CVV</label><input type="text" id="cvv" placeholder="000" maxlength="4" required></div>
            <div class="form-actions"><button type="button" class="btn-voltar" onclick="prevStep(3)">← VOLTAR</button><button type="submit" class="btn-proximo">PRÓXIMO →</button></div>
          </form>
        </div>
        <div class="step-content" id="step-4">
          <h2>CONFIRMAR PEDIDO</h2>
          <div class="confirmacao-container">
            <div class="confirmacao-item"><h3>Endereço de Entrega</h3><p id="confirmacao-endereco">Endereço será carregado</p></div>
            <div class="confirmacao-item"><h3>Forma de Pagamento</h3><p id="confirmacao-pagamento">Pagamento será carregado</p></div>
            <div class="resumo-pedido"><h3>Resumo do Pedido</h3><div id="resumo-itens"></div><div class="resumo-total"><div><span>Subtotal:</span> <span id="resumo-subtotal">R$ 0,00</span></div><div><span>Frete:</span> <span id="resumo-frete">R$ 0,00</span></div><div><strong><span>Total:</span> <span id="resumo-total-final">R$ 0,00</span></strong></div></div></div>
          </div>
          <div class="form-actions"><button type="button" class="btn-voltar" onclick="prevStep(4)">← VOLTAR</button><button type="button" class="btn-confirm">CONFIRMAR COMPRA</button></div>
        </div>
      </div>
    </div>
  </div>

</body>
</html>
<!-- ...existing code... -->